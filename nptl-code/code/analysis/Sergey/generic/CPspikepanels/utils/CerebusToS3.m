function [electrode, xpos, ypos] = CerebusToS3(X)
%% takes in cerebus channel numbers

% for each bank:
% [pin_num  electrode_num;
%  ...];

bankmap{1} = [1 93;
              3 94;
              5 75;
              7 85;
              9 86;
              11 87;
              13 77;
              15 66;
              17 76;
              19 67;
              21 58;
              23 78;
              25 68;
              27 69;
              29 59;
              31 49;
              2 92;
              4 95;
              6 96;
              8 97;
              10 98;
              12 88;
              14 99;
              16 89;
              18 90;
              20 79;
              22 80;
              24 70;
              26 60;
              28 50;
              30 40;
              32 30;
             ];
bankmap{2} = [1 83;
              3 73;
              5 63;
              7 53;
              9 43;
              11 44;
              13 33;
              15 34;
              17 24;
              19 35;
              21 25;
              23 26;
              25 27;
              27 28;
              29 29;
              31 19;
              2 84;
              4 74;
              6 64;
              8 54;
              10 55;
              12 45;
              14 46;
              16 65;
              18 56;
              20 47;
              22 57;
              24 36;
              26 37;
              28 38;
              30 48;
              32 39;
             ];
bankmap{3} = [1 81;
           3 71;
           5 61;
           7 51;
           9 41;
           11 31;
           13 21;
           15 11;
           17 2;
           19 3;
           21 4;
           23 15;
           25 16;
           27 17;
           29 8;
           31 20;
           2 82;
           4 72;
           6 62;
           8 52;
           10 42;
           12 32;
           14 22;
           16 12;
           18 23;
           20 13;
           22 14;
           24 5;
           26 6;
           28 7;
           30 18;
           32 9;
          ];


arraymap=[8 9 99
7 9 98
6 9 97
5 9 96
4 9 95
3 9 94
2 9 93
1 9 92
9 8 90
8 8 89
7 8 88
6 8 87
5 8 86
4 8 85
3 8 84
2 8 83
1 8 82
0 8 81
9 7 80
8 7 79
7 7 78
6 7 77
5 7 76
4 7 75
3 7 74
2 7 73
1 7 72
0 7 71
9 6 70
8 6 69
7 6 68
6 6 67
5 6 66
4 6 65
3 6 64
2 6 63
1 6 62
0 6 61
9 5 60
8 5 59
7 5 58
6 5 57
5 5 56
4 5 55
3 5 54
2 5 53
1 5 52
0 5 51
9 4 50
8 4 49
7 4 48
6 4 47
5 4 46
4 4 45
3 4 44
2 4 43
1 4 42
0 4 41
9 3 40
8 3 39
7 3 38
6 3 37
5 3 36
4 3 35
3 3 34
2 3 33
1 3 32
0 3 31
9 2 30
8 2 29
7 2 28
6 2 27
5 2 26
4 2 25
3 2 24
2 2 23
1 2 22
0 2 21
9 1 20
8 1 19
7 1 18
6 1 17
5 1 16
4 1 15
3 1 14
2 1 13
1 1 12
0 1 11
8 0 9
7 0 8
6 0 7
5 0 6
4 0 5
3 0 4
2 0 3
1 0 2];

for nbank = 1:3
    for nel = 1:32
        %channel num
        nch = (nbank-1)*32+nel;
        bind = find(bankmap{nbank}(:,1)==nel);
        electrode(nch) = bankmap{nbank}(bind,2);

        mapind = find(arraymap(:,3) == electrode(nch));
        xpos(nch) = arraymap(mapind,1);
        ypos(nch) = arraymap(mapind,2);
    end
end

%% if we find out the real mapping for S3, can modify this
%% for now, spit out a generic map
%electrode = X;
%xpos = mod(X,10);
%ypos = 9-floor(X/10);
